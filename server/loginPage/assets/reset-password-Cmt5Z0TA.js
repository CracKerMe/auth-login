import{h as J,m as P,u as Q,c as E,r as x,i as O,j as W,k as Z,l as ee,n as te,o as w,b as k,q as ne,d as b,s as N,t as R,v as le,x as ae,_ as oe,y as se,a as ue,e as D,w as z,f as H,F as K,z as re,p as ie,g as ce,A as ve,B as de,C as me}from"./index-BuizCe0p.js";import{F as pe}from"./FormItem-BysFT_pZ.js";var fe="^\\d+$";function T(m){const _=setTimeout(m,0),v=setTimeout(m,10),r=setTimeout(m,50);return[_,v,r]}var ge=["value"],he=J({name:"OTPInput",inheritAttrs:!1,__name:"OTPInput",props:P({maxlength:{},textAlign:{default:"left"},inputmode:{default:"numeric"},containerClass:{},accept:{},alt:{},autocomplete:{default:"one-time-code"},autofocus:{type:Boolean},capture:{type:[Boolean,String]},checked:{type:[Boolean,Array,Set]},crossorigin:{},disabled:{type:Boolean},enterKeyHint:{},form:{},formaction:{},formenctype:{},formmethod:{},formnovalidate:{type:Boolean},formtarget:{},height:{},indeterminate:{type:Boolean},list:{},max:{},min:{},minlength:{},multiple:{type:Boolean},name:{},pattern:{default:fe},placeholder:{},readonly:{type:Boolean},required:{type:Boolean},size:{},src:{},step:{},type:{},value:{},width:{}},{modelValue:{default:""},modelModifiers:{}}),emits:P(["complete","change","select","input","keydown","keyup","focus","blur","mouseover","mouseleave","mousedown","paste","touchend","touchmove","click","dblclick"],["update:modelValue"]),setup(m,{expose:_,emit:v}){const r=m,s=v,o=Q(m,"modelValue"),S=E(()=>r.pattern?typeof r.pattern=="string"?new RegExp(r.pattern):r.pattern:null),g=x(!1),h=x(!1),u=x(null),i=x(null),l=x(null);_({ref:l}),O(()=>{const e=l.value;if(!e)return e;const t=e.select.bind(e);e.select=()=>{t(),u.value=0,i.value=e.value.length};const n=document.createElement("style");n.id="input-otp-style",document.head.appendChild(n);const a=n.sheet;a==null||a.insertRule("[data-input-otp]::selection { background: transparent !important; }");const c=()=>{e&&e.style.setProperty("--root-height",`${e.clientHeight}px`)};c();const p=new ResizeObserver(c);p.observe(e),setTimeout(()=>{u.value=e.selectionStart,i.value=e.selectionEnd,h.value=document.activeElement===e},20),W(()=>{p.disconnect()})}),Z([()=>r.maxlength,o],([e,t],[n,a])=>{a&&t!==a&&a.length<e&&t.length===e&&s("complete",t)},{immediate:!0}),ee(e=>{if(!h.value)return;const t=setInterval(()=>{l.value&&document.activeElement===l.value&&(u.value=l.value.selectionStart,i.value=l.value.selectionEnd)},50);e(()=>{clearInterval(t)})});function d(){if(!l.value)return;const e=l.value.selectionStart,t=l.value.selectionEnd,n=e!==null&&t!==null;if(o.value.length!==0&&n){const a=e===t,c=e===o.value.length&&o.value.length<Number(r.maxlength);if(a&&!c){const p=e;let f=-1,y=-1;p===0?(f=0,y=1):p===o.value.length?(f=o.value.length-1,y=o.value.length):(f=p,y=p+1),f!==-1&&y!==-1&&l.value.setSelectionRange(f,y)}}T(()=>{var a,c;u.value=((a=l.value)==null?void 0:a.selectionStart)??null,i.value=((c=l.value)==null?void 0:c.selectionEnd)??null})}function C(e){T(d);const t=e.currentTarget.value.slice(0,r.maxlength);if(t.length>0&&S.value&&!S.value.test(t)){e.preventDefault();return}o.value=t,s("input",e)}function A(e){var F,V,I,L;const t=(F=e.clipboardData)==null?void 0:F.getData("text/plain");e.preventDefault();const n=(V=l.value)==null?void 0:V.selectionStart,a=(I=l.value)==null?void 0:I.selectionEnd,f=(n!==a?o.value.slice(0,n)+t+o.value.slice(a):o.value.slice(0,n)+t+o.value.slice(n)).slice(0,r.maxlength);if(f.length>0&&S.value&&!S.value.test(f))return;o.value=f,s("input",e);const y=Math.min(f.length,r.maxlength-1),B=f.length;(L=l.value)==null||L.setSelectionRange(y,B),u.value=y,i.value=B}function $(e){if(!l.value)return;const t=[l.value.selectionStart,l.value.selectionEnd];if(t[0]===null||t[1]===null)return;let n;if(t[0]===t[1])n=0;else if(t[1]-t[0]===1)n=1;else if(t[1]-t[0]>1)n=2;else throw new Error("Could not determine OTPInput selection type");if(e.key==="ArrowLeft"||e.key==="ArrowRight"||e.key==="ArrowUp"||e.key==="ArrowDown"||e.key==="Home"||e.key==="End"){if(e.key==="ArrowLeft"&&n===1&&!e.shiftKey&&!e.metaKey&&!e.ctrlKey&&!e.altKey){e.preventDefault();const a=Math.max(t[0]-1,0),c=Math.max(t[1]-1,1);l.value.setSelectionRange(a,c)}e.altKey&&!e.shiftKey&&(e.key==="ArrowLeft"||e.key==="ArrowRight")&&(e.preventDefault(),e.key==="ArrowLeft"&&l.value.setSelectionRange(0,Math.min(1,o.value.length)),e.key==="ArrowRight"&&l.value.setSelectionRange(Math.max(0,o.value.length-1),o.value.length))}}function q(e){e.preventDefault(),l.value&&l.value.focus()}function M(e){document.activeElement===e.currentTarget&&setTimeout(()=>{d()},50),s("touchend",e)}function j(e){var a,c;const t=(c=(a=l.value)==null?void 0:a.__metadata__)==null?void 0:c.lastClickTimestamp,n=document.activeElement===e.currentTarget;if(t!==void 0&&n&&Date.now()-t<=300){const p=e.currentTarget;p.setSelectionRange(0,p.value.length),T(d)}s("dblclick",e)}const G=E(()=>Array.from({length:Number(r.maxlength)}).map((e,t)=>{const n=h.value&&u.value!==null&&i.value!==null&&(u.value===i.value&&t===u.value||t>=u.value&&t<i.value),a=o.value[t]!==void 0?o.value[t]:null;return{char:a,isActive:n,hasFakeCaret:n&&a===null}})),X=te(),Y=E(()=>{var a;const{containerClass:e,value:t,...n}=r;return{...X,...n,pattern:(a=S.value)==null?void 0:a.source}});return(e,t)=>(w(),k("div",{"data-input-otp-container":"",style:le([{position:"relative","user-select":"none","-webkit-user-select":"none"},{cursor:e.disabled?"default":"text"}]),class:ae(e.containerClass),onMouseover:t[10]||(t[10]=n=>{g.value=!0,s("mouseover",n)}),onMouseleave:t[11]||(t[11]=n=>{g.value=!0,s("mouseleave",n)}),onMousedown:t[12]||(t[12]=n=>{e.disabled||q(n),s("mousedown",n)})},[ne(e.$slots,"default",{slots:G.value,isFocused:h.value,isHovering:!e.disabled&&g.value}),b("input",N({ref_key:"inputRef",ref:l,value:o.value,"data-input-otp":"",style:{position:"absolute",inset:0,width:"100%",height:"100%",display:"flex",textAlign:e.textAlign,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)"}},Y.value,{onSelect:t[0]||(t[0]=n=>{d(),s("select",n)}),onMouseover:t[1]||(t[1]=n=>{g.value=!0,s("mouseover",n)}),onMouseleave:t[2]||(t[2]=n=>{g.value=!1,s("mouseleave",n)}),onPaste:t[3]||(t[3]=n=>{A(n),s("paste",n)}),onTouchend:M,onTouchmove:M,onClick:t[4]||(t[4]=n=>{var a;l.value.__metadata__=Object.assign({},(a=l.value)==null?void 0:a.__metadata__,{lastClickTimestamp:Date.now()}),s("click",n)}),onDblclick:j,onChange:t[5]||(t[5]=n=>{R(T)(d),s("change",n)}),onInput:C,onKeydown:t[6]||(t[6]=n=>{$(n),R(T)(d),s("keydown",n)}),onKeyup:t[7]||(t[7]=n=>{R(T)(d),s("keyup",n)}),onFocus:t[8]||(t[8]=n=>{if(l.value){const a=Math.min(l.value.value.length,e.maxlength-1),c=l.value.value.length;l.value.setSelectionRange(a,c),u.value=a,i.value=c}h.value=!0,s("focus",n)}),onBlur:t[9]||(t[9]=n=>{h.value=!1,s("blur",n)})}),null,16,ge)],38))}}),ye=he;const U=m=>(ie("data-v-a8ebecd7"),m=m(),ce(),m),we=U(()=>b("p",{class:"form-item-sub"}," 请输入您的邮箱地址，我们将发送一封包含重置密码链接的邮件到您的邮箱。 ",-1)),ke=U(()=>b("p",{class:"label-name"},"邮箱验证码",-1)),be={class:"otp-wrapper flex"},_e={key:0},Se={key:1,class:"otp-box"},Ce={class:"otp-box-inner"},xe=["disabled"],Te={key:0},Ee={key:1},Re={class:"form-item-desc flex flex-center"},Ae={__name:"reset-password",setup(m){const _=se(),v=x({email:"",code:""}),r=x(!1);function s(u){return/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(u)}const o=E(()=>!(v.value.email&&s(v.value.email)&&v.value.code&&v.value.code.length===6&&!r.value)),S=(u,i)=>{v.value[i]=u},g=u=>{u&&u.preventDefault(),console.log(v.value),r.value=!0,setTimeout(()=>{r.value=!1},1e3)},h=u=>{console.log(u),g()};return O(()=>{console.log(_.query.email),_.query.email&&(v.value.email=_.query.email)}),(u,i)=>{const l=ue("router-link");return w(),k(K,null,[we,b("form",{class:"form",autocomplete:"off",onSubmit:g},[D(pe,{label:"邮箱",type:"email",placeholder:"请输入您的邮箱地址",value:v.value.email,name:"email",svg:'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 4H4c-1.103 0-2 .897-2 2v12c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2zm0 2v.511l-8 6.223-8-6.222V6h16zM4 18V9.044l7.386 5.745a.994.994 0 0 0 1.228 0L20 9.044 20.002 18H4z"></path></svg>',"onUpdate:value":i[0]||(i[0]=d=>S(d,"email")),readonly:""},null,8,["value"]),ke,D(R(ye),{modelValue:v.value.code,"onUpdate:modelValue":i[1]||(i[1]=d=>v.value.code=d),maxlength:6,onComplete:h},{default:z(({slots:d})=>[b("div",be,[(w(!0),k(K,null,re(d,(C,A)=>(w(),k("div",N({ref_for:!0},C,{key:A,class:{current:C.hasFakeCaret}}),[C.char?(w(),k("p",_e,ve(C.char),1)):(w(),k("div",Se,[de(b("div",Ce,null,512),[[me,C.isActive]])]))],16))),128))])]),_:1},8,["modelValue"]),b("button",{class:"submit-btn",type:"submit",shape:"block",disabled:o.value},[r.value?(w(),k("span",Te,"重置密码中...")):(w(),k("span",Ee,"重置密码"))],8,xe),b("p",Re,[H(" 返回"),D(l,{to:"/login"},{default:z(()=>[H("登录")]),_:1})])],32)],64)}}},Be=oe(Ae,[["__scopeId","data-v-a8ebecd7"]]);export{Be as default};
